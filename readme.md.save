# Despliegue de Infraestructura LAMP Distribuida con Ansible

Este proyecto permite la automatización, instalación y configuración de un stack LAMP (Linux, Apache, MariaDB, PHP) sobre una infraestructura distribuida utilizando servidores Ubuntu.

## Arquitectura del Proyecto
La infraestructura se divide en dos grupos principales definidos en el inventario:
- webservers: Nodos dedicados al servidor web (Apache) y el motor de procesamiento PHP.
- dbservers: Nodo dedicado exclusivamente al motor de base de datos (MariaDB).

## Estructura de Archivos
- inventory.ini: Listado de servidores, variables de conexión y rutas de certificados.
- playbook-instalacion-ssh.yml: Playbook para el despliegue de llaves públicas.
- playbook-automatizar-login.yml: Configuración de privilegios sudo sin contraseña, para utomatizar acceso.
- playbook-lamp.yml: Orquestación del despliegue de servicios Apache, PHP y MariaDB.
- certificados_ssh/: Directorio local que almacena las llaves privadas y públicas.

---

## Guía de Comandos y Operación

### 1. Configuración de Acceso SSH
Comando: ansible-playbook playbook-instalacion-ssh.yml -i inventory.ini -k -K
Descripción: Copia la llave pública del nodo de control a los nodos gestionados.
Parámetros: -k solicita la contraseña de SSH y -K la contraseña de sudo del usuario remoto.

### 2. Verificación de Conectividad
Comando: ansible all -i inventory.ini -m ping
Descripción: Valida que los nodos estén en línea y que Ansible tenga permisos de ejecución sobre ellos.

### 3. Automatización de Privilegios (Passwordless Sudo)
Comando: ansible-playbook -i inventory.ini playbook-automatizar-login.yml --limit Servidores_LAMP -k -K
Descripción: Configura el archivo en /etc/sudoers.d/ de los servidores para permitir la ejecución de comandos administrativos sin solicitar contraseña.

### 4. Despliegue del Stack LAMP
Comando: ansible-playbook -i inventory.ini playbook-lamp.yml --limit Servidores_LAMP
Descripción: Instala y configura todos los paquetes de software necesarios. Al haber automatizado el login previamente, no se requieren parámetros adicionales de contraseña.

### 5. Validación de Servicios Web y PHP
Comando: ansible webservers -i inventory.ini -m shell -a "systemctl is-active apache2 && php -v | head -n 1"
Descripción: Confirma de forma remota que Apache está activo y muestra la versión de PHP instalada en los servidores del grupo web.

### 6. Validación de Base de Datos
Comando: ansible dbservers -i inventory.ini -m shell -a "systemctl is-active mariadb && mariadb --version"
Descripción: Confirma que el servicio MariaDB está en ejecución y devuelve la versión instalada en el grupo de bases de datos.

---

## Notas de Seguridad
El directorio certificados_ssh/ debe estar incluido en el archivo .gitignore para evitar la exposición de llaves privadas en repositorios públicos.
